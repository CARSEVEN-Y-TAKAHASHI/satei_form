<script>
  document.getElementById('sateiForm').addEventListener('submit', function(e) {
    e.preventDefault();

    const form = e.target;
    const data = {
      name: form.name.value,
      phone: form.phone.value,
      car: form.car.value,
      date1: form.date1.value,
      time1: form.time1.value,
      date2: form.date2.value,
      time2: form.time2.value,
      date3: form.date3.value,
      time3: form.time3.value,
      other: form.other.value
    };

    fetch('https://script.google.com/macros/s/AKfycbyHlAM1fR56t6-0BOguWRX1PIcGXReMsnwnRpE3rKDFClhHSMbiguhcjP-YV6uMV-nJUw/exec', {
      method: 'POST',
      headers: {
        "Content-Type": "application/json"
      },
      body: JSON.stringify(data)
    })
    .then(res => res.json())
    .then(res => {
      if (res.result === 'success') {
        alert("ありがとうございます！受付が完了いたしました。営業時間内に店舗よりご連絡をさせていただきますので、しばらくお待ちください。");
        form.reset();
      } else {
        alert("送信に失敗しました。");
      }
    })
    .catch(() => {
      alert("送信に失敗しました。");
    });
  });
</script>
