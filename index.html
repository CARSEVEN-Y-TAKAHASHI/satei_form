<!DOCTYPE html>
<html>
  <head>
    <base target="_top">
  </head>
  <body>
    <form id="sateiForm">
      <label>お名前: <input name="name" required></label><br>
      <label>電話番号: <input name="phone" required></label><br>
      <label>車種: <input name="car" required></label><br>
      <label>希望日時①: <input name="date1" type="date" required> <input name="time1" type="time" required></label><br>
      <label>希望日時②: <input name="date2" type="date"> <input name="time2" type="time"></label><br>
      <label>希望日時③: <input name="date3" type="date"> <input name="time3" type="time"></label><br>
      <label>その他ご要望: <textarea name="other"></textarea></label><br>
      <input type="submit" value="送信">
    </form>
    <div id="status"></div>
    
    <script>
      const form = document.getElementById("sateiForm");
      form.addEventListener("submit", (e) => {
        e.preventDefault();
        const formData = Object.fromEntries(new FormData(form).entries());
        google.script.run
          .withSuccessHandler(() => {
            document.getElementById("status").innerText = "送信が完了しました！";
            form.reset();
          })
          .withFailureHandler(() => {
            document.getElementById("status").innerText = "送信に失敗しました。";
          })
          .submitForm(formData);
      });
    </script>
  </body>
</html>
